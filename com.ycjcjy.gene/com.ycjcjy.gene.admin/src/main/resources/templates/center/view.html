<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" >
<head th:replace="/public/head :: onLoadHead(首页)">

</head>
<style>
    .selectOption {
        width: 90%;
        margin: 50px auto 20px auto;
        background-color: #fff;
        color: #999;
        padding: 0 30px;
        box-sizing: border-box;
    }
    .selectOption select {
        margin-top: 9px;
        width: 130px;
        height: 25px;
        color: #000;
    }
    .selectOption .search {
        width: 200px;
        background-color: #fff;
    }
    .selectOption .select_item p{
        display: inline-block;
    }
    .selectOption .select_item p{
        color: #ababab;
    }
    .selectOption .select_item span{
        display: inline-block;
        font-size: 14px;
        padding: 2px 10px;
        color: #000;
        cursor: pointer;
        transition: all 0.3s linear;-webkit-user-select:none;

        -moz-user-select:none;

        -ms-user-select:none;

        user-select:none;
    }
    .selectOption .select_item span.active {
        color: #fff;
        padding: 2px 30px;
        background-image: linear-gradient(24deg, #fca96a 0%, #fed706 100%);
        border-radius: 15px;
    }
    .mainData {
        width: 95%;
        margin: 50px 0 0 auto;
    }
    .mainData .box {
        text-align: center;
        width: 28%;
        margin: 0 5.33333% 30px 0;
        padding: 0 20px 0 20px;
        box-sizing: border-box;
        border-radius: 2px;
        line-height: 100px;
        min-height: 100px;
        background-color: #fff;
    }
    .mainData .box p {
        display: inline-block;
        margin: 0;
        color: #000;
    }
    .mainData .box p i{
        font-style: normal;
        color: orange;
        font-size: 28px;
    }
    .mainData .box p:nth-of-type(1){
        font-size: 18px;
    }
    .mainData .box p:nth-of-type(2){
        font-size: 24px;
        color: #868E8E;
    }
    .mainData .bottom .box {
        padding: 24px 24px;
    }
    .mainData .bottom .box .img_cont {
        width: 80px;
        height: 80px;
        margin-right: 20px;
    }
    .mainData .bottom .box p {
        text-align: left;
    }
    .mainData .bottom .box p:nth-of-type(1) {
        margin-bottom: 35px;
        font-size: 16px;
    }
    .mainData .bottom .box p:nth-of-type(2) {
        font-size: 32px;
    }
    .mainData .bottom .box{
        line-height: 0;
    }
    .mainData .bottom P{
        margin: 0;
        display: block;
        line-height: 20px;
    }
    #boxtable table thead tr th{
        text-align: center;
    }
    #boxtable .am-table>thead>tr>th {
        background-color: #f9f9f9;
        border-bottom: none;
    }
    #boxtable table tbody tr td{
        background-color: #fff;
        color: #000;
    }
    #boxtable .am-table>tbody>tr>td, .am-table>tbody>tr>th, .am-table>tfoot>tr>td, .am-table>tfoot>tr>th, .am-table>thead>tr>td, .am-table>thead>tr>th {
        border-top: 1px solid #eceff6;
    }
    #boxtable table tbody tr td:nth-of-type(1),#boxtable table thead tr th:nth-of-type(1) {
        width: 20%;
    }
    #boxtable table tbody tr td:nth-of-type(2),#boxtable table thead tr th:nth-of-type(2) {
        width: 15%;
    }
    #boxtable table tbody tr td:nth-of-type(3),#boxtable table thead tr th:nth-of-type(3) {
        width: 15%;
    }
    #boxtable table tbody tr td:nth-of-type(4),#boxtable table thead tr th:nth-of-type(4) {
        width: 15%;
    }
    #boxtable table tbody tr td:nth-of-type(4),#boxtable table thead tr th:nth-of-type(5) {
        width: 20%;
    }
    #boxtable table tbody tr td:nth-of-type(4),#boxtable table thead tr th:nth-of-type(6) {
        width: 15%;
    }
</style>
<body data-type="index">
<div class="am-g tpl-g">
    <!-- 模态提示组件 -->
    <div th:include="/public/tips :: Tips"></div>

    <!-- 内容区域 -->
    <div class="tpl-content-wrapper onebean-frame-index">
        <div class="mainData">
            <div class="top am-cf">
                <div class="box am-fl am-cf">
                    <p class="am-fl">今日&nbsp;/&nbsp;本月 营收</p>
                    <p class="am-fr" id="jrys"><i>--</i>&nbsp;/&nbsp;--</p>
                </div>
                <div class="box am-fl am-cf">
                    <p class="am-fl">今日课程数</p>
                    <p class="am-fr"><i id="jrkc">--</i></p>
                </div>
                <div class="box am-fl am-cf">
                    <p class="am-fl">明日课程数</p>
                    <p class="am-fr"><i id="mrkc">--</i></p>
                </div>
            </div>
            <div class="top am-cf">
                <div class="box am-fl am-cf">
                    <p class="am-fl">今日新增/总 会员</p>
                    <p class="am-fr" id="jrhy"><i>--</i>&nbsp;/&nbsp;--</p>
                </div>
                <div class="box am-fl am-cf" >
                    <p class="am-fl">今日预约&nbsp;/&nbsp;签到人数</p>
                    <p class="am-fr" id="jryy"><i>--</i>&nbsp;/&nbsp;--</p>
                </div>
                <div class="box am-fl am-cf">
                    <p class="am-fl">明日预约人数</p>
                    <p class="am-fr"><i id="mryy">--</i></p>
                </div>
            </div>
            <div class="bottom am-cf">
                <p style="margin-bottom: 20px;font-size: 14px">本月课程概况</p>
                <div class="box am-fl am-cf">
                    <div class="img_cont am-fl">
                        <img th:src="@{/assets/img/icon01.png}" alt="" width="100%" height="100%">
                    </div>
                    <div class="am-fl">
                        <p>排课量/共享教室</p>
                        <p id="mpk">--</p>
                    </div>
                </div>
                <div class="box am-fl am-cf">
                    <div class="img_cont am-fl">
                        <img th:src="@{/assets/img/icon02.png}" alt="" width="100%" height="100%">
                    </div>
                    <div class="am-fl">
                        <p>下单量/共享教室</p>
                        <p id="mxd">--</p>
                    </div>
                </div>
                <div class="box am-fl am-cf">
                    <div class="img_cont am-fl">
                        <img th:src="@{/assets/img/icon03.png}" alt="" width="100%" height="100%">
                    </div>
                    <div class="am-fl">
                        <p>签到量</p>
                        <p id="mqd">--</p>
                    </div>
                </div>
            </div>
        </div>

        <div  style="width:90%; margin: 0px auto;background-color: #fff;overflow: hidden">
            <div class="selectOption am-cf">
                <div class="am-fl">
                    <select name="options" id="caseSeelct" selected onclick="TuChange2()"></select>
                </div>
                <div class="am-fr select_item">
                    <div class="am-fr">
                        <p>时间：</p>
                        <span onclick="tuChange(0,$(this))">昨日</span>
                        <span onclick="tuChange(1,$(this))">本周</span>
                        <span  class="active" onclick="tuChange(2,$(this))">本月</span>
                    </div>
                </div>
            </div>
            <div id="container" style="height: 500px;"></div>
        </div>
        <div id="boxtable" style="width: 90%; margin: 50px auto 100px auto;">
            <table class="am-table">
                <thead align="center">
                    <tr>
                        <th>日期</th>
                        <th>排课</th>
                        <th>下单</th>
                        <th>预约量</th>
                        <th>签到量</th>
                        <th>签到率</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>



    </div>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-gl/echarts-gl.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-stat/ecStat.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/dataTool.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/china.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/world.js"></script>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/bmap.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/simplex.js"></script>



<css th:replace="/public/css :: onLoadCSS"></css>
<script th:src="${oss_ctx}+@{system_assets/js/chart/echarts.min.js}" type="text/javascript"></script>
<js th:replace="/public/js :: onLoadJS"></js>
<script th:src="${oss_ctx}+@{system_assets/js/chart/amazeui.datatables.min.js}" type="text/javascript"></script>
<script th:src="${oss_ctx}+@{system_assets/js/chart/dataTables.responsive.min.js}" type="text/javascript"></script>
<script th:src="${oss_ctx}+@{system_assets/js/chart/demoChart.js}" type="text/javascript"></script>
    <script type="text/javascript">
        var dom = document.getElementById("container");
        var myChart = echarts.init(dom);
        var app = {};
        initTu("",2);
        //初始化所有案场
        function initAllCase() {
            var target = $("#caseSeelct");
            $.ajax({
                type:'get',
                dataType:'json',
                url:'[(${ctx})]/syscasefield/findAllCase',
                success:function (result) {
                    var values = result.data;
                    target.html('');
                    if(values.length!=0){
                        var html = '<option value="-1" >' +'全部'+ '</option>';
                        for(var i=0;i<values.length;i++){
                            html+='<option value="'+values[i].id+'">'+values[i].casefieldname+'</option>';
                        }
                    }
                    target.html(html);
                }
            })
        }
        var $dateType = 2;
        initAllCase();
        initData();
        function tuChange(dateType,el){
            el.addClass('active').siblings().removeClass('active')
            $dateType = dateType;
            initTu($("#caseSeelct").val(),dateType);
        }
        function initData() {
            var param = {};
            doPost("/index/showData",param,function (res) {


                var mxd = res.mxd;
                var mpk = res.mpk;
                var mqd = res.mqd;

                var map1 = res.map1;
                var map2 = res.map2;
                var map3 = res.map3;
                var map4 = res.map4;

                $("#mxd").html(mxd);
                $("#mpk").html(mpk);
                $("#mqd").html(mqd);
                //

                $("#jrys").html("<i>"+map2.days+"</i>&nbsp;/&nbsp;"+map2.mon);
                $("#jrhy").html("<i>"+map3.nowday+"</i>&nbsp;/&nbsp;"+map3.total);
                $("#jryy").html("<i>"+map4.nownum+"</i>&nbsp;/&nbsp;"+map4.signnum);
                $("#jrkc").html(map1.nowday);
                $("#mrkc").html(map1.tomorrowday);
                $("#mryy").html(map4.tomorronum);

            });
        }
        function initTable(caseId,dateType) {
            var param = {dateType:dateType,caseId:caseId}
            doPost("/index/showTable",param,function (res) {
                var list = res.data;
                $("#tableBody").html("");
                var html = "";
                for(var i=0;i<list.length;i++){
                    html+='<tr align="center">';
                    html+='<td>'+list[i].date+'</td>';
                    html+='<td>'+list[i].coursenum+'</td>';
                    html+='<td>'+list[i].ordernum+'</td>';
                    html+='<td>'+list[i].allnum+'</td>';
                    html+='<td>'+list[i].vfnum+'</td>';
                    html+='<td>'+list[i].vfnum+'/'+list[i].allnum+'('+list[i].ppp+')</td>';
                    html+='</tr>';
                }
                $("#tableBody").html(html);

            });
        }
        function TuChange2() {
            initTu($("#caseSeelct").val(),$dateType);
        }

        function initTu(caseId,dateType) {
            var param = {dateType:dateType,caseId:caseId}
            doPost("/index/showTu",param,function (res) {
                console.log(res.cnList)

                myChart.setOption(

                    {
                        title: {
                            text: ''
                        },
                        tooltip: {
                            trigger: 'axis'
                        },
                        legend: {
                            data:['排课量','签到量','下单量']
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        toolbox: {
                            feature: {
                                saveAsImage: {}
                            }
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: res.timeList
                        },
                        yAxis: {
                            type: 'value'
                        },
                        series: [
                            {
                                name:'排课量',
                                type:'line',
                                data:res.cnList
                            },
                            {
                                name:'签到量',
                                type:'line',
                                data:res.ovList
                            },
                            {
                                name:'下单量',
                                type:'line',
                                data:res.ocList
                            }
                        ]
                    }, true);




            });
            initTable(caseId,dateType);

        }






    </script>
</body>
</html>